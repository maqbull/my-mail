(this["webpackJsonpmy-mail"]=this["webpackJsonpmy-mail"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(8),s=n.n(a),i=n(3),u=n(2),o={firstName:"Dave",lastName:"Ceddia",username:"dave",avatar:"https://www.gravatar.com/avatar/205e460b479e2e5b48aec07710c08d50"},l=[{id:0,subject:"Hey Dave",body:"Yo just wanted to say hey."},{id:1,subject:"React is Great",body:"Yo just wanted to say hey."},{id:2,subject:"Learn JavaScript",body:"Yo just wanted to say hey."},{id:3,subject:"Job notification",body:"Yo just wanted to say hey."}],j=Array(2e3).fill(0).map((function(e){var t=l[Math.floor(Math.random()*l.length)];return Object(u.a)(Object(u.a)({},t),{},{id:Math.random(),preview:t.body.substr(0,46)})}));l.forEach((function(e){return e.preview=e.body.substr(0,46)}));var b=n(0),d=c.a.createContext();function m(e){var t=e.children,n=Object(r.useState)(o),c=Object(i.a)(n,2),a=c[0],s=c[1],u=Object(r.useCallback)((function(e){return s(e)}),[]),l=Object(r.useCallback)((function(){return s(null)}),[]),j=Object(r.useMemo)((function(){return{user:a,login:u,logout:l}}),[a,u,l]);return Object(b.jsx)(d.Provider,{value:j,children:t})}function O(){return Object(r.useContext)(d)}function f(){var e=Object(r.useContext)(d);return{login:e.login,logout:e.logout}}var h=function(){var e=Object(r.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),s=Object(i.a)(a,2),u=s[0],l=s[1],j=Object(r.useState)(""),d=Object(i.a)(j,2),m=d[0],O=d[1],h=Object(r.useState)(""),v=Object(i.a)(h,2),x=v[0],g=v[1],p=f().login;return Object(b.jsxs)("div",{className:"LoginPage",children:[Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c(null),l(!0),function(e,t){return new Promise((function(n,r){setTimeout((function(){"dave"===e&&"secret"===t?n(o):r({message:"Invalid username or password"})}),300)}))}(m,x).then((function(e){l(!1),p({user:e})})).catch((function(e){c(e),l(!1)}))},children:[Object(b.jsx)("label",{htmlFor:"username",children:"Username"}),Object(b.jsx)("input",{type:"text",name:"username",id:"username",value:m,onChange:function(e){return O(e.target.value)}}),Object(b.jsx)("label",{htmlFor:"password",children:"Password"}),Object(b.jsx)("input",{type:"password",name:"password",id:"password",value:x,onChange:function(e){return g(e.target.value)}}),Object(b.jsx)("button",{children:"Log In"})]}),u?Object(b.jsx)("div",{className:"loading",children:"Loading.."}):"",n?Object(b.jsx)("div",{className:"error",children:n.message}):""]})},v=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useRef)(),s=O().user,u=f().logout,o=function(e){e.target!==a.current&&c(!1)};return Object(r.useEffect)((function(){return document.addEventListener("click",o),function(){return document.removeEventListener("click",o)}})),Object(b.jsxs)("div",{className:"UserMenu",children:[Object(b.jsx)("img",{className:"UserAvatar",src:s.avatar,alt:"User Avatar",onClick:function(){c((function(e){return!e}))},ref:a}),n&&Object(b.jsx)("ul",{children:Object(b.jsx)("li",{onClick:u,children:"Logout"})})]})},x=function(){return Object(b.jsxs)("header",{className:"Header",children:[Object(b.jsx)("h2",{children:"MyMail"}),Object(b.jsx)(v,{})]})},g=n(5),p=c.a.createContext();function y(e){var t=e.children,n=Object(r.useState)([]),c=Object(i.a)(n,2),a=c[0],s=c[1],u=Object(r.useCallback)((function(e){s((function(t){return[].concat(Object(g.a)(t),[{id:Math.random(),text:e,addedAt:(new Date).getTime()}])}))}),[]),o=Object(r.useCallback)((function(e){s((function(t){return t.filter((function(t){return t!==e}))}))}),[]);Object(r.useEffect)((function(){var e=setInterval((function(){var e=(new Date).getTime();s((function(t){return t.filter((function(t){return e-t.addedAt<3e3}))}))}),6e3);return function(){return clearInterval(e)}}),[]);var l=Object(r.useMemo)((function(){return{messages:a,addMessage:u}}),[a,u]);return Object(b.jsxs)(p.Provider,{value:l,children:[Object(b.jsx)("div",{className:"notification-wrapper",children:Object(b.jsx)("ul",{children:a.map((function(e){return Object(b.jsx)(w,{message:e,onClose:function(){return o(e)}},e.id)}))})}),t]})}var w=function(e){var t=e.message,n=e.onClose;return Object(b.jsxs)("li",{className:"notification",children:[Object(b.jsxs)("span",{children:["  ",t.text," "]}),Object(b.jsx)("button",{className:"close",onClick:n,children:"\xd7"})]})};var C=c.a.createContext();function N(e,t){switch(t.type){case"begin":return Object(u.a)(Object(u.a)({},e),{},{loading:!0,error:null});case"success":return Object(u.a)(Object(u.a)({},e),{},{loading:!1,emails:t.emails});case"error":return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.error});case"select_email":return Object(u.a)(Object(u.a)({},e),{},{currentEmail:t.email});case"add_emails":return Object(u.a)(Object(u.a)({},e),{},{emails:[].concat(Object(g.a)(e.emails),Object(g.a)(t.emails))});default:return e}}function k(e){var t=e.children,n=Object(r.useReducer)(N,{emails:[],loading:!1,error:null,currentEmail:null}),c=Object(i.a)(n,2),a=c[0],s=c[1],o=O().user,d=Object(r.useContext)(p).addMessage;Object(r.useEffect)((function(){s({type:"begin"}),new Promise((function(e){setTimeout((function(){e(j)}),300)})).then((function(e){return s({type:"success",emails:e})})).catch((function(e){return s({type:"error",error:e})}))}),[]),Object(r.useEffect)((function(){var e;return o&&(e=setInterval((function(){a.loading||new Promise((function(e){setTimeout((function(){e(l.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{id:Math.random()})})).slice(0,Math.floor(100*Math.random())))}),3e3)})).then((function(e){e.length>0&&(s({type:"add_emails",emails:e}),d("".concat(e.length," email").concat(1===e.length?"":"s","   arrived ")))}))}),1e3)),function(){return clearInterval(e)}}));var m=Object(r.useCallback)((function(e){return s({type:"select_email",email:e})}),[]),f=Object(r.useMemo)((function(){return Object(u.a)(Object(u.a)({},a),{},{setCurrentEmail:m})}),[a,m]);return Object(b.jsx)(C.Provider,{value:f,children:t})}function M(){return Object(r.useContext)(C)}var E=c.a.memo((function(e){var t=e.email,n=e.onClick;return Object(b.jsxs)("li",{className:"messages",onClick:function(){return n(t)},children:[Object(b.jsx)("div",{className:"subject",children:t.subject}),Object(b.jsx)("div",{className:"preview",children:t.preview})]})})),L=function(){var e=O(),t=M(),n=t.emails,r=t.loading,c=t.error,a=t.setCurrentEmail;return Object(b.jsx)("div",{className:"MessageList",children:c?Object(b.jsx)("div",{className:"no-messages",children:"Error!"}):r?Object(b.jsx)("div",{className:"loading",children:"Loading ..."}):0===n.length?Object(b.jsxs)("div",{className:"no-messages",children:["Your mailbox is empty , ",e.firstName,"!"]}):Object(b.jsx)("ul",{children:n.map((function(e){return Object(b.jsx)(E,{email:e,onClick:function(){return a(e)}},e.id)}))})})},S=function(){var e=M(),t=e.currentEmail,n=e.setCurrentEmail;return Object(b.jsxs)("div",{className:"MessageViewer",children:[Object(b.jsx)("button",{onClick:function(){return n(null)},children:"Back"}),Object(b.jsx)("h2",{children:t.subject}),Object(b.jsx)("div",{children:t.body})]})},P=function(){var e=M().currentEmail;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(x,{}),Object(b.jsx)("main",{children:e?Object(b.jsx)(S,{}):Object(b.jsx)(L,{})})]})};var I=function(e){var t=e.children;return Object(b.jsx)(y,{children:Object(b.jsx)(m,{children:Object(b.jsxs)(k,{children:[" ",t," "]})})})};n(14);function A(){return O()?Object(b.jsx)(P,{}):Object(b.jsx)(h,{})}s.a.render(Object(b.jsxs)(I,{children:[" ",Object(b.jsx)(A,{})," "]}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.527b4ee3.chunk.js.map